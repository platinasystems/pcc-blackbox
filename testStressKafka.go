package main

import (
	"encoding/json"
	"fmt"
	log "github.com/platinasystems/go-common/logs"
	"github.com/platinasystems/go-kafka-avro"
	avro2 "github.com/platinasystems/pcc-models/agent/avro"
	avro3 "github.com/platinasystems/pcc-models/network/avro"
	avro "github.com/platinasystems/tiles/pccserver/kafka/models/storage"
	avro4 "github.com/platinasystems/tiles/systemCollector/models/avro"
	"sync"
	"testing"
	"time"
)

const PARTITIONS = "{\"timestamp\":1647616373173,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"cluster\":\"\",\"site\":\"\",\"partitions\":[{\"device\":\"sysfs\",\"mountpoint\":\"/sys\",\"fstype\":\"sysfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"proc\",\"mountpoint\":\"/proc\",\"fstype\":\"proc\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"udev\",\"mountpoint\":\"/dev\",\"fstype\":\"devtmpfs\",\"mountoptions\":\"rw,nosuid,noexec,relatime,size=16372816k,nr_inodes=4093204,mode=755\",\"total\":15989,\"free\":15989,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":4093204,\"inodesUsed\":539,\"inodesFree\":4092665,\"inodesUsedPercent\":0.013168167},{\"device\":\"devpts\",\"mountpoint\":\"/dev/pts\",\"fstype\":\"devpts\",\"mountoptions\":\"rw,nosuid,noexec,relatime,gid=5,mode=620,ptmxmode=000\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"tmpfs\",\"mountpoint\":\"/run\",\"fstype\":\"tmpfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,size=3283560k,mode=755\",\"total\":3206,\"free\":3204,\"used\":2,\"usedPercent\":0.07784234,\"inodesTotal\":4104449,\"inodesUsed\":1172,\"inodesFree\":4103277,\"inodesUsedPercent\":0.028554382},{\"device\":\"/dev/mapper/ubuntu--vg-ubuntu--lv\",\"mountpoint\":\"/\",\"fstype\":\"ext4\",\"mountoptions\":\"rw,relatime\",\"total\":200561,\"free\":180993,\"used\":19568,\"usedPercent\":10.282884,\"inodesTotal\":13107200,\"inodesUsed\":161352,\"inodesFree\":12945848,\"inodesUsedPercent\":1.2310181},{\"device\":\"securityfs\",\"mountpoint\":\"/sys/kernel/security\",\"fstype\":\"securityfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"tmpfs\",\"mountpoint\":\"/dev/shm\",\"fstype\":\"tmpfs\",\"mountoptions\":\"rw,nosuid,nodev\",\"total\":16033,\"free\":16033,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":4104449,\"inodesUsed\":4,\"inodesFree\":4104445,\"inodesUsedPercent\":9.7455224E-5},{\"device\":\"tmpfs\",\"mountpoint\":\"/run/lock\",\"fstype\":\"tmpfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,size=5120k\",\"total\":5,\"free\":5,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":4104449,\"inodesUsed\":5,\"inodesFree\":4104444,\"inodesUsedPercent\":1.2181903E-4},{\"device\":\"tmpfs\",\"mountpoint\":\"/sys/fs/cgroup\",\"fstype\":\"tmpfs\",\"mountoptions\":\"ro,nosuid,nodev,noexec,mode=755\",\"total\":16033,\"free\":16033,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":4104449,\"inodesUsed\":18,\"inodesFree\":4104431,\"inodesUsedPercent\":4.385485E-4},{\"device\":\"cgroup2\",\"mountpoint\":\"/sys/fs/cgroup/unified\",\"fstype\":\"cgroup2\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,nsdelegate\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/systemd\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,xattr,name=systemd\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"pstore\",\"mountpoint\":\"/sys/fs/pstore\",\"fstype\":\"pstore\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"none\",\"mountpoint\":\"/sys/fs/bpf\",\"fstype\":\"bpf\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,mode=700\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/cpu,cpuacct\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,cpu,cpuacct\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/net_cls,net_prio\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,net_cls,net_prio\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/freezer\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,freezer\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/memory\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,memory\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/cpuset\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,cpuset\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/rdma\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,rdma\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/devices\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,devices\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/blkio\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,blkio\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/pids\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,pids\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/hugetlb\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,hugetlb\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"cgroup\",\"mountpoint\":\"/sys/fs/cgroup/perf_event\",\"fstype\":\"cgroup\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,perf_event\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"systemd-1\",\"mountpoint\":\"/proc/sys/fs/binfmt_misc\",\"fstype\":\"autofs\",\"mountoptions\":\"rw,relatime,fd=28,pgrp=1,timeout=0,minproto=5,maxproto=5,direct,pipe_ino=19636\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"hugetlbfs\",\"mountpoint\":\"/dev/hugepages\",\"fstype\":\"hugetlbfs\",\"mountoptions\":\"rw,relatime,pagesize=2M\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"mqueue\",\"mountpoint\":\"/dev/mqueue\",\"fstype\":\"mqueue\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"debugfs\",\"mountpoint\":\"/sys/kernel/debug\",\"fstype\":\"debugfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"tracefs\",\"mountpoint\":\"/sys/kernel/tracing\",\"fstype\":\"tracefs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"fusectl\",\"mountpoint\":\"/sys/fs/fuse/connections\",\"fstype\":\"fusectl\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"configfs\",\"mountpoint\":\"/sys/kernel/config\",\"fstype\":\"configfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"/dev/sda2\",\"mountpoint\":\"/boot\",\"fstype\":\"ext4\",\"mountoptions\":\"rw,relatime\",\"total\":975,\"free\":769,\"used\":206,\"usedPercent\":22.687822,\"inodesTotal\":65536,\"inodesUsed\":316,\"inodesFree\":65220,\"inodesUsedPercent\":0.48217773},{\"device\":\"/dev/loop1\",\"mountpoint\":\"/snap/core18/2284\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":55,\"free\":0,\"used\":55,\"usedPercent\":100.0,\"inodesTotal\":10847,\"inodesUsed\":10847,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"/dev/loop2\",\"mountpoint\":\"/snap/core20/1361\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":62,\"free\":0,\"used\":62,\"usedPercent\":100.0,\"inodesTotal\":11777,\"inodesUsed\":11777,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"/dev/loop5\",\"mountpoint\":\"/snap/lxd/22526\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":68,\"free\":0,\"used\":68,\"usedPercent\":100.0,\"inodesTotal\":799,\"inodesUsed\":799,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"/dev/loop4\",\"mountpoint\":\"/snap/lxd/21835\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":67,\"free\":0,\"used\":67,\"usedPercent\":100.0,\"inodesTotal\":796,\"inodesUsed\":796,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"/dev/loop6\",\"mountpoint\":\"/snap/snapd/14978\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":43,\"free\":0,\"used\":43,\"usedPercent\":100.0,\"inodesTotal\":480,\"inodesUsed\":480,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"/dev/loop3\",\"mountpoint\":\"/snap/core20/1376\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":62,\"free\":0,\"used\":62,\"usedPercent\":100.0,\"inodesTotal\":11777,\"inodesUsed\":11777,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"/dev/loop7\",\"mountpoint\":\"/snap/snapd/15177\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":43,\"free\":0,\"used\":43,\"usedPercent\":100.0,\"inodesTotal\":482,\"inodesUsed\":482,\"inodesFree\":0,\"inodesUsedPercent\":100.0},{\"device\":\"tmpfs\",\"mountpoint\":\"/run/snapd/ns\",\"fstype\":\"tmpfs\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime,size=3283560k,mode=755\",\"total\":3206,\"free\":3204,\"used\":2,\"usedPercent\":0.07784234,\"inodesTotal\":4104449,\"inodesUsed\":1172,\"inodesFree\":4103277,\"inodesUsedPercent\":0.028554382},{\"device\":\"nsfs\",\"mountpoint\":\"/run/snapd/ns/lxd.mnt\",\"fstype\":\"nsfs\",\"mountoptions\":\"rw\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"binfmt_misc\",\"mountpoint\":\"/proc/sys/fs/binfmt_misc\",\"fstype\":\"binfmt_misc\",\"mountoptions\":\"rw,nosuid,nodev,noexec,relatime\",\"total\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},{\"device\":\"tmpfs\",\"mountpoint\":\"/var/lib/ceph/osd/ceph-0\",\"fstype\":\"tmpfs\",\"mountoptions\":\"rw,relatime\",\"total\":16033,\"free\":16032,\"used\":1,\"usedPercent\":3.1672948E-4,\"inodesTotal\":4104449,\"inodesUsed\":15,\"inodesFree\":4104434,\"inodesUsedPercent\":3.654571E-4},{\"device\":\"/dev/loop8\",\"mountpoint\":\"/snap/core18/2344\",\"fstype\":\"squashfs\",\"mountoptions\":\"ro,nodev,relatime\",\"total\":55,\"free\":0,\"used\":55,\"usedPercent\":100.0,\"inodesTotal\":10849,\"inodesUsed\":10849,\"inodesFree\":0,\"inodesUsedPercent\":100.0}]}"
const STORAGE = "{\"timestamp\":1647616463291,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"cluster\":\"\",\"site\":\"\",\"numDrives\":2,\"storageControllers\":[{\"controller\":\"Broadcom / LSI MegaRAID SAS-3 3108 [Invader] PERC H730 Mini\",\"vendor\":\"Broadcom / LSI\",\"model\":\"MegaRAID SAS-3 3108 [Invader]\",\"subsystem\":\"PERC H730 Mini\",\"revision\":\"0x02\",\"businfo\":\"0000:02:00.0\",\"driver\":\"megaraid_sas\",\"Type\":\"external\",\"status\":\"active\",\"tags\":[\"external\"],\"drives\":[{\"name\":\"sdb\",\"serialNumber\":\"S0N4JHH90000K604KEA2\",\"wwid\":\"wwn-0x5000c5008e6b3deb\",\"Total_Capacity\":900185481216,\"Capacity_Free\":41705824256,\"vendor\":\"SEAGATE\",\"Model\":\"SLTN0900S5xnN010\",\"Online\":true,\"Transport\":\"SATA/SAS\",\"Media_Type\":\"Rotational\",\"capability\":50,\"stats\":{\"readCount\":205987,\"mergedReadCount\":18,\"writeCount\":20016,\"mergedWriteCount\":30157,\"readBytes\":3209853952,\"writeBytes\":1587900416,\"readTime\":216274,\"writeTime\":205410,\"iopsInProgress\":0,\"ioTime\":163892,\"weightedIO\":350360,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":37289,\"writeThroughputBS\":0,\"readLatencyMS\":0,\"writeLatencyMS\":0,\"name\":\"sdb\",\"serialNumber\":\"\",\"label\":\"\"},\"partitions\":[{\"name\":\"sdb1\",\"size\":858477559808,\"stats\":{\"readCount\":10077,\"mergedReadCount\":18,\"writeCount\":19573,\"mergedWriteCount\":27274,\"readBytes\":2235348992,\"writeBytes\":1573556736,\"readTime\":200994,\"writeTime\":200980,\"iopsInProgress\":0,\"ioTime\":99856,\"weightedIO\":345720,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":0,\"writeThroughputBS\":0,\"readLatencyMS\":0,\"writeLatencyMS\":0,\"name\":\"sdb1\",\"serialNumber\":\"\",\"label\":\"\"},\"filesystem\":{\"uuid\":\"\",\"device\":\"\",\"mountpoint\":\"\",\"fstype\":\"\",\"mountoptions\":\"\",\"total\":0,\"avail\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},\"volumes\":[{\"uuid\":\"LVM-fkNqSs2YuR20ErFm7HWXhcOFuA0aQGC3jJWnPsRYaB37T8t9NDLG8FJjHtQd0kyo\",\"name\":\"ceph_data_5c32-ceph_data_5c32\",\"size\":858473365504,\"Type\":\"LVM\",\"filesystem\":{\"uuid\":\"\",\"device\":\"\",\"mountpoint\":\"\",\"fstype\":\"\",\"mountoptions\":\"\",\"total\":0,\"avail\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0}}]},{\"name\":\"sdb2\",\"size\":2097152,\"stats\":{\"readCount\":184088,\"mergedReadCount\":0,\"writeCount\":1,\"mergedWriteCount\":0,\"readBytes\":754771968,\"writeBytes\":4096,\"readTime\":12125,\"writeTime\":2,\"iopsInProgress\":0,\"ioTime\":58572,\"weightedIO\":184,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":37289,\"writeThroughputBS\":0,\"readLatencyMS\":0,\"writeLatencyMS\":0,\"name\":\"sdb2\",\"serialNumber\":\"\",\"label\":\"\"},\"filesystem\":{\"uuid\":\"\",\"device\":\"\",\"mountpoint\":\"\",\"fstype\":\"\",\"mountoptions\":\"\",\"total\":0,\"avail\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},\"volumes\":[]}],\"volumes\":[]},{\"name\":\"sda\",\"serialNumber\":\"S0N489610000K551F047\",\"wwid\":\"wwn-0x5000c5008de350eb\",\"Total_Capacity\":900185481216,\"Capacity_Free\":2908160,\"vendor\":\"SEAGATE\",\"Model\":\"SLTN0900S5xnN010\",\"Online\":true,\"Transport\":\"SATA/SAS\",\"Media_Type\":\"Rotational\",\"capability\":50,\"stats\":{\"readCount\":188101,\"mergedReadCount\":17822,\"writeCount\":2248773,\"mergedWriteCount\":1537865,\"readBytes\":3030387712,\"writeBytes\":78294011904,\"readTime\":224551,\"writeTime\":47926924,\"iopsInProgress\":0,\"ioTime\":11299060,\"weightedIO\":43570428,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":28515,\"writeThroughputBS\":1123085,\"readLatencyMS\":0,\"writeLatencyMS\":16,\"name\":\"sda\",\"serialNumber\":\"\",\"label\":\"\"},\"partitions\":[{\"name\":\"sda1\",\"size\":1048576,\"stats\":{\"readCount\":144915,\"mergedReadCount\":0,\"writeCount\":0,\"mergedWriteCount\":0,\"readBytes\":593557504,\"writeBytes\":0,\"readTime\":18166,\"writeTime\":0,\"iopsInProgress\":0,\"ioTime\":67516,\"weightedIO\":5428,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":28515,\"writeThroughputBS\":0,\"readLatencyMS\":0,\"writeLatencyMS\":0,\"name\":\"sda1\",\"serialNumber\":\"\",\"label\":\"\"},\"filesystem\":{\"uuid\":\"\",\"device\":\"\",\"mountpoint\":\"\",\"fstype\":\"\",\"mountoptions\":\"\",\"total\":0,\"avail\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},\"volumes\":[]},{\"name\":\"sda2\",\"size\":1073741824,\"stats\":{\"readCount\":247,\"mergedReadCount\":24,\"writeCount\":716,\"mergedWriteCount\":59,\"readBytes\":9780224,\"writeBytes\":169283584,\"readTime\":1206,\"writeTime\":61626,\"iopsInProgress\":0,\"ioTime\":3124,\"weightedIO\":61088,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":0,\"writeThroughputBS\":0,\"readLatencyMS\":0,\"writeLatencyMS\":0,\"name\":\"sda2\",\"serialNumber\":\"\",\"label\":\"\"},\"filesystem\":{\"uuid\":\"456f64ef-cb30-429a-a4b8-9e69ece3b75a\",\"device\":\"/dev/sda2\",\"mountpoint\":\"/boot\",\"fstype\":\"ext4\",\"mountoptions\":\"rw,relatime\",\"total\":975,\"avail\":702,\"free\":769,\"used\":206,\"usedPercent\":22.687822,\"inodesTotal\":65536,\"inodesUsed\":316,\"inodesFree\":65220,\"inodesUsedPercent\":0.48217773},\"volumes\":[]},{\"name\":\"sda3\",\"size\":899107782656,\"stats\":{\"readCount\":42721,\"mergedReadCount\":17798,\"writeCount\":2248057,\"mergedWriteCount\":1537806,\"readBytes\":2421103616,\"writeBytes\":78124728320,\"readTime\":203837,\"writeTime\":47865298,\"iopsInProgress\":0,\"ioTime\":11240668,\"weightedIO\":43502772,\"errorCount\":0,\"temperature\":0.0,\"readThroughputBS\":0,\"writeThroughputBS\":1123085,\"readLatencyMS\":0,\"writeLatencyMS\":16,\"name\":\"sda3\",\"serialNumber\":\"\",\"label\":\"\"},\"filesystem\":{\"uuid\":\"\",\"device\":\"\",\"mountpoint\":\"\",\"fstype\":\"\",\"mountoptions\":\"\",\"total\":0,\"avail\":0,\"free\":0,\"used\":0,\"usedPercent\":0.0,\"inodesTotal\":0,\"inodesUsed\":0,\"inodesFree\":0,\"inodesUsedPercent\":0.0},\"volumes\":[{\"uuid\":\"LVM-yuaCNwXRJ2d42SXRK1OFDl4I3xHFKryUFaMsKGTKJLym2wAbMA195Af0j94F0kij\",\"name\":\"ubuntu--vg-ubuntu--lv\",\"size\":214748364800,\"Type\":\"LVM\",\"filesystem\":{\"uuid\":\"43a4f776-e538-4338-a9cb-f920c6466edd\",\"device\":\"/dev/mapper/ubuntu--vg-ubuntu--lv\",\"mountpoint\":\"/\",\"fstype\":\"ext4\",\"mountoptions\":\"rw,relatime\",\"total\":200561,\"avail\":170736,\"free\":180992,\"used\":19569,\"usedPercent\":10.283017,\"inodesTotal\":13107200,\"inodesUsed\":161352,\"inodesFree\":12945848,\"inodesUsedPercent\":1.2310181}}]}],\"volumes\":[]}]}]}"
const CPU = "{\"timestamp\":1647616514211,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"cluster\":\"\",\"site\":\"\",\"us\":0.5,\"sy\":0.3,\"id\":98.9,\"wa\":0.3,\"st\":0.0,\"ni\":0.0,\"hi\":0.0,\"si\":0.0,\"cpuLoad\":0.8024072}"
const MEMORY = "{\"timestamp\":1647616539656,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"cluster\":\"\",\"site\":\"\",\"totalMem\":16071.715,\"usedMem\":469.1328,\"freeMem\":10520.988,\"sharedMem\":434.01172,\"bufferMem\":442.6953,\"cachedMem\":4638.8984,\"totalSwap\":0.0,\"usedSwap\":0.0,\"freeSwap\":0.0,\"cachedSwap\":0.0,\"availableMem\":97.08101,\"realUsedMem\":2.918991}"
const NETWORK = "{\"timestamp\":1647616567521,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"clusterName\":\"net11\",\"clusterId\":10,\"networkIfaceNames\":[\"xeth2-1\",\"xeth1-1\",\"xeth1-2\"],\"clusterHealthState\":\"OK\",\"clusterHealthErrors\":[],\"site\":\"\",\"interfaces\":[{\"name\":\"lo\",\"flags\":[\"up\",\"loopback\"],\"mtu\":65536,\"addresses\":[\"127.0.0.1/8\",\"::1/128\"],\"hardwareAddress\":\"\",\"upOrDown\":\"up\",\"bytesSent\":236628946,\"bytesReceived\":236628946,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":1216772,\"packetsReceived\":1216772,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"eth0\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[\"172.17.2.70/23\",\"fe80::5218:4cff:fe00:28ad/64\"],\"hardwareAddress\":\"50:18:4c:00:28:ad\",\"upOrDown\":\"up\",\"bytesSent\":4410186656,\"bytesReceived\":1076349566,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":11445689,\"packetsReceived\":10075006,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":1000,\"connectionMode\":\"full\"},{\"name\":\"eth1\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":9728,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:ae\",\"upOrDown\":\"up\",\"bytesSent\":33709110,\"bytesReceived\":10195086,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":308165,\"packetsReceived\":104031,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":10000,\"connectionMode\":\"full\"},{\"name\":\"eth2\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":9728,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:af\",\"upOrDown\":\"up\",\"bytesSent\":67196223,\"bytesReceived\":20241576,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":613189,\"packetsReceived\":204816,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":10000,\"connectionMode\":\"full\"},{\"name\":\"dummy0\",\"flags\":[\"broadcast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"8a:77:1f:41:95:bc\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"lo0\",\"flags\":[\"up\",\"broadcast\"],\"mtu\":1500,\"addresses\":[\"10.0.1.1/32\",\"fe80::ac8c:f6ff:fe9a:c547/64\"],\"hardwareAddress\":\"ae:8c:f6:9a:c5:47\",\"upOrDown\":\"unknown\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"control0\",\"flags\":[\"up\",\"broadcast\"],\"mtu\":1500,\"addresses\":[\"10.15.0.0/32\",\"fe80::28dc:d6ff:fecd:c8b9/64\"],\"hardwareAddress\":\"2a:dc:d6:cd:c8:b9\",\"upOrDown\":\"unknown\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"docker0\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[\"172.18.0.1/16\"],\"hardwareAddress\":\"02:42:b6:dc:18:cb\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":9724,\"addresses\":[\"fe80::5218:4cff:fe00:28ae/64\"],\"hardwareAddress\":\"50:18:4c:00:28:ae\",\"upOrDown\":\"unknown\",\"bytesSent\":100905333,\"bytesReceived\":82330047,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":921354,\"packetsReceived\":921678,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":1,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth1-1\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[\"10.16.0.2/31\",\"fe80::5218:4cff:fe00:28b0/64\"],\"hardwareAddress\":\"50:18:4c:00:28:b0\",\"upOrDown\":\"up\",\"bytesSent\":218890495766,\"bytesReceived\":164359709439,\"avgXmitRate\":0.6551724137931034,\"avgXmitUsage\":0.013103448275862068,\"avgRcvRate\":1.5517241379310345,\"avgRcvUsage\":0.031034482758620693,\"packetsSent\":226379653,\"packetsReceived\":186348879,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":10000,\"connectionMode\":\"full\"},{\"name\":\"xeth1-2\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[\"10.16.0.4/31\",\"fe80::5218:4cff:fe00:28d0/64\"],\"hardwareAddress\":\"50:18:4c:00:28:d0\",\"upOrDown\":\"up\",\"bytesSent\":195116160716,\"bytesReceived\":428777839186,\"avgXmitRate\":0.7931034482758621,\"avgXmitUsage\":0.015862068965517243,\"avgRcvRate\":2.2758620689655173,\"avgRcvUsage\":0.04551724137931035,\"packetsSent\":254281445,\"packetsReceived\":395523974,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":10000,\"connectionMode\":\"full\"},{\"name\":\"xeth1-3\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:f0\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth1-4\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:29:10\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth2-1\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[\"10.16.0.0/31\",\"fe80::5218:4cff:fe00:28b1/64\"],\"hardwareAddress\":\"50:18:4c:00:28:b1\",\"upOrDown\":\"up\",\"bytesSent\":346317978596,\"bytesReceived\":167177429916,\"avgXmitRate\":3.0689655172413794,\"avgXmitUsage\":0.061379310344827596,\"avgRcvRate\":0.7241379310344828,\"avgRcvUsage\":0.014482758620689654,\"packetsSent\":318553119,\"packetsReceived\":217342918,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":10000,\"connectionMode\":\"full\"},{\"name\":\"xeth2-2\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:d1\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth2-3\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:f1\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth2-4\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:29:11\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth3\",\"flags\":[\"up\",\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b2\",\"upOrDown\":\"lowerlayerdown\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":100000,\"connectionMode\":\"full\"},{\"name\":\"xeth4\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b3\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth5\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b4\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth6\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b5\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth7\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b6\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth8\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b7\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth9\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b8\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth10\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:b9\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth11\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:ba\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth12\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:bb\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth13\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:bc\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth14\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:bd\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth15\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:be\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth16\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:bf\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth17\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c0\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth18\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c1\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth19\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c2\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth20\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c3\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth21\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c4\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth22\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c5\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth23\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c6\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth24\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c7\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth25\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c8\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth26\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:c9\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth27\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:ca\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth28\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:cb\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth29\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:cc\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth30\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:cd\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth31\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:ce\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"},{\"name\":\"xeth32\",\"flags\":[\"broadcast\",\"multicast\"],\"mtu\":1500,\"addresses\":[],\"hardwareAddress\":\"50:18:4c:00:28:cf\",\"upOrDown\":\"down\",\"bytesSent\":0,\"bytesReceived\":0,\"avgXmitRate\":0.0,\"avgXmitUsage\":0.0,\"avgRcvRate\":0.0,\"avgRcvUsage\":0.0,\"packetsSent\":0,\"packetsReceived\":0,\"errin\":0,\"errout\":0,\"dropin\":0,\"dropout\":0,\"fifoin\":0,\"fifoout\":0,\"speed\":0,\"connectionMode\":\"half\"}],\"throughput\":9.068965,\"throughputPercent\":0.0}"
const SENSOR = "{\"timestamp\":1647616597598,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"cluster\":\"\",\"site\":\"\",\"intakeTemperature\":39.0,\"exhaustTemperature\":43.0,\"powerIn\":151.0,\"powerOut\":131.75,\"powerInPercentage\":30.2,\"powerOutPercentage\":26.4,\"cpuTemp\":61.0,\"cpuMaxTemp\":82.0,\"cpuCriticalTemp\":104.0}"
const SYSTEM = "{\"timestamp\":1647616627561,\"hostname\":\"i70\",\"node\":\"\",\"nodeId\":11,\"nodeUuid\":\"0c49c7f6-2773-11ec-a9ab-0242ac10001e\",\"cluster\":\"\",\"site\":\"\",\"uptime\":1222886,\"bootTime\":1646393742,\"loggedUsers\":0,\"oneMinLoadAvg\":1.21,\"fiveMinLoadAvg\":1.3,\"fifteenMinLoadAvg\":1.28,\"totProcesses\":144,\"totRunning\":11,\"totSleeping\":79,\"totStopped\":0,\"totZombie\":0}"

func testStressKafka(t *testing.T) {

	nodesN := Env.Monitor.FakeNodesNumber
	if nodesN <= 0 {
		nodesN = 1
	}
	startId := uint64(1)

	nodes, err := Pcc.GetNodes()
	if err != nil {
		t.Fatal(err)
	}

	for i := range *nodes {
		if (*nodes)[i].Id > startId {
			startId = (*nodes)[i].Id
		}
	}

	log.AuctaLogger.Infof("Kafka Stress test. Simulating %d nodes", nodesN)

	pusher := func(id uint64) {
		var (
			storage    avro.Storage
			memory     avro2.Memory
			cpu        avro2.Cpu
			network    avro3.Network
			sensor     avro4.Sensor
			partitions avro4.Partitions
			system     avro4.System
		)
		nodeName := fmt.Sprintf("fakenode%d", id)
		nodeUuid := fmt.Sprintf("fake-uuid-%d,", id)
		timestamp := time.Now().Unix()

		json.Unmarshal([]byte(CPU), &cpu)
		cpu.NodeId = id
		cpu.Name = nodeName

		json.Unmarshal([]byte(STORAGE), &storage)
		storage.NodeId = int64(id)
		storage.Node = nodeName
		storage.NodeUuid = nodeUuid
		storage.Timestamp = timestamp

		json.Unmarshal([]byte(MEMORY), &memory)
		memory.NodeId = id
		memory.Name = nodeName

		json.Unmarshal([]byte(NETWORK), &network)
		network.NodeId = int64(id)
		network.Node = nodeName
		network.NodeUuid = nodeUuid

		json.Unmarshal([]byte(PARTITIONS), &partitions)
		partitions.NodeId = int64(id)
		partitions.Node = nodeName
		partitions.NodeUuid = nodeUuid

		json.Unmarshal([]byte(SENSOR), &sensor)
		sensor.NodeId = int64(id)
		sensor.Node = nodeName
		sensor.NodeUuid = nodeUuid

		json.Unmarshal([]byte(SYSTEM), &system)
		system.NodeId = int64(id)
		system.Node = nodeName
		system.NodeUuid = nodeUuid

		producer, err := kafka.NewAvroProducerCustomConfig(
			[]string{"127.0.0.1:9092"},
			[]string{"http://127.0.0.1:8081"},
			nil)
		if err != nil {
			t.Fatal(err)
		}
		fmt.Printf("Kafka producer for pusher %d correctly created\n", id)

		push := func(topic string, schema string, item interface{}) {
			jsonValue, _ := json.Marshal(item)
			_, _, e := producer.AddWithResponse(fmt.Sprintf("%s", topic), schema, []byte(fmt.Sprintf("%v", timestamp)), jsonValue)
			if e != nil {
				fmt.Println(e)
			}
		}

		for {
			push("cpu", cpu.Schema(), &cpu)
			push("storage", storage.Schema(), &storage)
			push("memory", memory.Schema(), &memory)
			push("network", network.Schema(), &network)
			push("sensor", sensor.Schema(), &sensor)
			push("partitions", partitions.Schema(), &partitions)
			push("system", system.Schema(), &system)
			fmt.Printf("Node %d pushed\n", id)
			time.Sleep(time.Duration(60) * time.Second)
		}
	}

	wg := sync.WaitGroup{}
	for i := 1; i <= nodesN; i++ {
		wg.Add(1)
		go pusher(startId + uint64(i))
	}

	wg.Wait()

}
